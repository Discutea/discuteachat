!function(a){a.fn.discuteaChat=function(b){var c=a.extend({locale:"en",title:"",channel:"Accueil",url:"",post:!1,cookies:!1},b),d={username:function(){switch(c.locale){case"fr":return"Pseudo";case"es":return"Seudónimo";default:return"Nickname"}},years:function(){switch(c.locale){case"fr":return"ans";case"es":return"años";default:return"years"}},age:function(){switch(c.locale){case"fr":return"Votre age";case"es":return"Tu edad";default:return"Your age"}},signin:function(){switch(c.locale){case"fr":return"Connexion";case"es":return"Conexión";default:return"Sign in"}},formtitle:function(){if("object"==typeof c.title&&(title=c.title[c.locale],"undefined"!=typeof title))return title;if(""!=c.title&&"object"!=typeof c.title)return c.title;switch(c.locale){case"fr":return"Tchat accès visiteurs.";case"es":return"Chat visitantes acceden.";default:return"Chat access visitors."}},channel:function(){return"object"==typeof c.channel&&(channel=c.channel[c.locale],"undefined"!=typeof channel)?channel.replace(/\s/g,"-"):"object"==typeof c.channel?"Accueil":c.channel.replace(/\s/g,"-")},appletUrl:function(){if(""!=c.url)return c.url;switch(c.locale){case"fr":return"https://chat.discutea.fr/";case"es":return"https://kiwi.discutea.es/";default:return"https://kiwi.discutea.net/"}}},e={username:function(){return c.cookies&&Cookies.get("Username")?user=field='value="'+Cookies.get("Username"):field='placeholder="'+d.username(),field+='"',output='<div class="field">                             <input type="text" id="username" name="username" required="required" maxlength="20" '+field+" />                           </div>",output},year:function(){for(output='<div class="field">                             <select id="age" name="age" required="required">                               <option value="">'+d.age()+"</option>",i=13;i<90;i++)output+='<option value="'+i+'"',c.cookies&&Cookies.get("Year")&&i==Cookies.get("Year")&&(output+=" selected "),output+=">"+i+" "+d.years()+"</option>";return output+="</select></div>",output},gender:function(){return output='<div class="field">                             <div id="gender">                              <input type="radio" id="gender_0" name="[gender]" required="required" value="F"',c.cookies&&Cookies.get("Sex")&&"F"==Cookies.get("Sex")&&(output+=" checked "),output+='/>                             <label for="gender_0" class="required">                               <img alt="Woman" src="https://cdn.discutea.com/img/femme.png"/>                             </label>                             <input type="radio" id="gender_1" name="[gender]" required="required" value="M"',c.cookies&&Cookies.get("Sex")&&"M"==Cookies.get("Sex")&&(output+=" checked "),output+='/>                             <label for="gender_1" class="required">                               <img alt="Man" src="https://cdn.discutea.com/img/homme.png"/>                             </label>                           </div>                         </div>',output},assembler:function(){return output='<div id="discuteaTchat">                             <h3>'+d.formtitle()+'</h3>                             <form name="tchat" method="post" action="#" id="formChat">',output+=this.username(),output+=this.year(),output+=this.gender(),output+="<div class='submit'>                              <input type='submit' class='button-chat' value='"+d.signin()+"' />                            </div></form></div>",output}},f={onSubmit:function(b){b.preventDefault(),nick=a("#username").val(),age=a("#age").val(),a("#gender_1").is(":checked")===!0?gender="M":gender="F",url=d.appletUrl(),c.post===!1?(url+="?nick="+nick,url+="&age="+age,url+="&gender="+gender,url+="&channel="+d.channel(),window.location.href=url):(form=a("<form></form>"),form.attr("method","post"),form.attr("action",url),form.append('<input type="hidden" name="tchat[username]" value="'+nick+'">'),form.append('<input type="hidden" name="tchat[age]" value="'+age+'">'),form.append('<input type="hidden" name="tchat[sexe]" value="'+gender+'">'),form.append('<input type="hidden" name="tchat[channel]" value="'+d.channel()+'">'),a(form).appendTo("body").submit())}};this.html(e.assembler()),c.cookies&&(a("#username",this).blur(function(){console.log(a(this).val()),Cookies.set("Username",a(this).val(),{expires:365})}),a("#age",this).change(function(){Cookies.set("Year",a(this).val(),{expires:365})}),a("#gender",this).change(function(){Cookies.set("Sex",a("input[type='radio']:checked",this).val(),{expires:365})})),a("#formChat").submit(function(a){f.onSubmit(a)})}}(jQuery);
